{"ast":null,"code":"/**\r\n * @author jscastro / https://github.com/jscastro76\r\n */\n\nconst THREE = require(\"./CSS2DRenderer.js\");\nfunction LabelRenderer(map) {\n  this.map = map;\n  this.renderer = new THREE.CSS2DRenderer();\n  this.renderer.setSize(this.map.getCanvas().clientWidth, this.map.getCanvas().clientHeight);\n  this.renderer.domElement.style.position = 'absolute';\n  this.renderer.domElement.id = 'labelCanvas'; //TODO: this value must come by parameter\n  this.renderer.domElement.style.top = 0;\n  this.renderer.domElement.style.zIndex = \"0\";\n  this.map.getCanvasContainer().appendChild(this.renderer.domElement);\n  this.scene, this.camera;\n  this.dispose = function () {\n    this.map.getCanvasContainer().removeChild(this.renderer.domElement);\n    this.renderer.domElement.remove();\n    this.renderer = {};\n  };\n  this.setSize = function (width, height) {\n    this.renderer.setSize(width, height);\n  };\n  this.map.on('resize', function () {\n    this.renderer.setSize(this.map.getCanvas().clientWidth, this.map.getCanvas().clientHeight);\n  }.bind(this));\n  this.state = {\n    reset: function () {\n      //TODO: Implement a good state reset, check out what is made in WebGlRenderer\n    }\n  };\n  this.render = async function (scene, camera) {\n    this.scene = scene;\n    this.camera = camera;\n    return new Promise(resolve => {\n      resolve(this.renderer.render(scene, camera));\n    });\n  };\n\n  //[jscastro] method to toggle Layer visibility\n  this.toggleLabels = async function (layerId, visible) {\n    return new Promise(resolve => {\n      resolve(this.setVisibility(layerId, visible, this.scene, this.camera, this.renderer));\n    });\n  };\n\n  //[jscastro] method to set visibility\n  this.setVisibility = function (layerId, visible, scene, camera, renderer) {\n    var cache = this.renderer.cacheList;\n    cache.forEach(function (l) {\n      if (l.visible != visible && l.layer === layerId) {\n        if (visible && l.alwaysVisible || !visible) {\n          l.visible = visible;\n          renderer.renderObject(l, scene, camera);\n        }\n      }\n    });\n  };\n}\nmodule.exports = exports = LabelRenderer;","map":{"version":3,"names":["THREE","require","LabelRenderer","map","renderer","CSS2DRenderer","setSize","getCanvas","clientWidth","clientHeight","domElement","style","position","id","top","zIndex","getCanvasContainer","appendChild","scene","camera","dispose","removeChild","remove","width","height","on","bind","state","reset","render","Promise","resolve","toggleLabels","layerId","visible","setVisibility","cache","cacheList","forEach","l","layer","alwaysVisible","renderObject","module","exports"],"sources":["/Users/mihailbaleev/Documents/GitHub/lastochka_spraying/node_modules/threebox-plugin/src/objects/LabelRenderer.js"],"sourcesContent":["/**\r\n * @author jscastro / https://github.com/jscastro76\r\n */\r\n\r\nconst THREE = require(\"./CSS2DRenderer.js\");\r\n\r\nfunction LabelRenderer(map) {\r\n\r\n\tthis.map = map;\r\n\r\n\tthis.renderer = new THREE.CSS2DRenderer();\r\n\r\n\tthis.renderer.setSize(this.map.getCanvas().clientWidth, this.map.getCanvas().clientHeight);\r\n\tthis.renderer.domElement.style.position = 'absolute';\r\n\tthis.renderer.domElement.id = 'labelCanvas'; //TODO: this value must come by parameter\r\n\tthis.renderer.domElement.style.top = 0;\r\n\tthis.renderer.domElement.style.zIndex = \"0\";\r\n\tthis.map.getCanvasContainer().appendChild(this.renderer.domElement);\r\n\r\n\tthis.scene, this.camera;\r\n\r\n\tthis.dispose = function () {\r\n\t\tthis.map.getCanvasContainer().removeChild(this.renderer.domElement)\r\n\t\tthis.renderer.domElement.remove();\r\n\t\tthis.renderer = {};\r\n\t}\r\n\r\n\tthis.setSize = function (width, height) {\r\n\t\tthis.renderer.setSize(width, height);\r\n\t}\r\n\r\n\tthis.map.on('resize', function () {\r\n\t\tthis.renderer.setSize(this.map.getCanvas().clientWidth, this.map.getCanvas().clientHeight);\r\n\t}.bind(this));\r\n\r\n\tthis.state = {\r\n\t\treset: function () {\r\n\t\t\t//TODO: Implement a good state reset, check out what is made in WebGlRenderer\r\n\t\t}\r\n\t}\r\n\r\n\tthis.render = async function (scene, camera) {\r\n\t\tthis.scene = scene;\r\n\t\tthis.camera = camera;\r\n\t\treturn new Promise((resolve) => { resolve(this.renderer.render(scene, camera)) }); \r\n\t}\r\n\r\n\t//[jscastro] method to toggle Layer visibility\r\n\tthis.toggleLabels = async function (layerId, visible) {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tresolve(this.setVisibility(layerId, visible, this.scene, this.camera, this.renderer));\r\n\t\t}) \r\n\t};\r\n\r\n\t//[jscastro] method to set visibility\r\n\tthis.setVisibility = function (layerId, visible, scene, camera, renderer) {\r\n\t\tvar cache = this.renderer.cacheList;\r\n\t\tcache.forEach(function (l) {\r\n\t\t\tif (l.visible != visible && l.layer === layerId) {\r\n\t\t\t\tif ((visible && l.alwaysVisible) || !visible) {\r\n\t\t\t\t\tl.visible = visible;\r\n\t\t\t\t\trenderer.renderObject(l, scene, camera);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n}\r\n\r\nmodule.exports = exports = LabelRenderer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}